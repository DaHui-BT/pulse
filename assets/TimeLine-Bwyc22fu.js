var le=Object.defineProperty;var oe=(e,t,a)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var N=(e,t,a)=>oe(e,typeof t!="symbol"?t+"":t,a);import{h as j}from"./moment-C5S46NFB.js";import{R as ce}from"./request-DbUJaofx.js";import{d as M,i as Q,u as k,G as D,c as o,aa as y,e as ee,a5 as te,g as de,m as me,_ as U,r as ue,am as ge,a8 as pe,bm as he,au as Y,a as F,I as fe,n as G,h as K,o as $e,p as _,P as A,K as g,q as Z,x,C as B,L as ve,y as Se,O as J,F as Ie,Z as _e,E as ye}from"./index-CorvJS88.js";import{B as Le}from"./index-CMYvEKCm.js";import{T as R}from"./Text-Cl0HkLD1.js";import{a as c,B as be}from"./Base-C89d3xn4.js";import{L as q}from"./UserService-44F7kqZC.js";import{P as ae}from"./Paragraph-D8tPocoY.js";import{T as ie}from"./Title-BugShTsl.js";import{L as Te}from"./index-Bev_jMqz.js";const Ce=()=>({prefixCls:String,color:String,dot:y.any,pending:ee(),position:y.oneOf(te("left","right","")).def(""),label:y.any}),H=M({compatConfig:{MODE:3},name:"ATimelineItem",props:Q(Ce(),{color:"blue",pending:!1}),slots:Object,setup(e,t){let{slots:a}=t;const{prefixCls:r}=k("timeline",e),i=D(()=>({[`${r.value}-item`]:!0,[`${r.value}-item-pending`]:e.pending})),d=D(()=>/blue|red|green|gray/.test(e.color||"")?void 0:e.color||"blue"),f=D(()=>({[`${r.value}-item-head`]:!0,[`${r.value}-item-head-${e.color||"blue"}`]:!d.value}));return()=>{var p,$,m;const{label:s=(p=a.label)===null||p===void 0?void 0:p.call(a),dot:n=($=a.dot)===null||$===void 0?void 0:$.call(a)}=e;return o("li",{class:i.value},[s&&o("div",{class:`${r.value}-item-label`},[s]),o("div",{class:`${r.value}-item-tail`},null),o("div",{class:[f.value,!!n&&`${r.value}-item-head-custom`],style:{borderColor:d.value,color:d.value}},[n]),o("div",{class:`${r.value}-item-content`},[(m=a.default)===null||m===void 0?void 0:m.call(a)])])}}}),xe=e=>{const{componentCls:t}=e;return{[t]:U(U({},ue(e)),{margin:0,padding:0,listStyle:"none",[`${t}-item`]:{position:"relative",margin:0,paddingBottom:e.timeLineItemPaddingBottom,fontSize:e.fontSize,listStyle:"none","&-tail":{position:"absolute",insetBlockStart:e.timeLineItemHeadSize,insetInlineStart:(e.timeLineItemHeadSize-e.timeLineItemTailWidth)/2,height:`calc(100% - ${e.timeLineItemHeadSize}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px ${e.lineType} ${e.colorSplit}`},"&-pending":{[`${t}-item-head`]:{fontSize:e.fontSizeSM,backgroundColor:"transparent"},[`${t}-item-tail`]:{display:"none"}},"&-head":{position:"absolute",width:e.timeLineItemHeadSize,height:e.timeLineItemHeadSize,backgroundColor:e.colorBgContainer,border:`${e.timeLineHeadBorderWidth}px ${e.lineType} transparent`,borderRadius:"50%","&-blue":{color:e.colorPrimary,borderColor:e.colorPrimary},"&-red":{color:e.colorError,borderColor:e.colorError},"&-green":{color:e.colorSuccess,borderColor:e.colorSuccess},"&-gray":{color:e.colorTextDisabled,borderColor:e.colorTextDisabled}},"&-head-custom":{position:"absolute",insetBlockStart:e.timeLineItemHeadSize/2,insetInlineStart:e.timeLineItemHeadSize/2,width:"auto",height:"auto",marginBlockStart:0,paddingBlock:e.timeLineItemCustomHeadPaddingVertical,lineHeight:1,textAlign:"center",border:0,borderRadius:0,transform:"translate(-50%, -50%)"},"&-content":{position:"relative",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.lineWidth,marginInlineStart:e.margin+e.timeLineItemHeadSize,marginInlineEnd:0,marginBlockStart:0,marginBlockEnd:0,wordBreak:"break-word"},"&-last":{[`> ${t}-item-tail`]:{display:"none"},[`> ${t}-item-content`]:{minHeight:e.controlHeightLG*1.2}}},[`&${t}-alternate,
        &${t}-right,
        &${t}-label`]:{[`${t}-item`]:{"&-tail, &-head, &-head-custom":{insetInlineStart:"50%"},"&-head":{marginInlineStart:`-${e.marginXXS}px`,"&-custom":{marginInlineStart:e.timeLineItemTailWidth/2}},"&-left":{[`${t}-item-content`]:{insetInlineStart:`calc(50% - ${e.marginXXS}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}},"&-right":{[`${t}-item-content`]:{width:`calc(50% - ${e.marginSM}px)`,margin:0,textAlign:"end"}}}},[`&${t}-right`]:{[`${t}-item-right`]:{[`${t}-item-tail,
            ${t}-item-head,
            ${t}-item-head-custom`]:{insetInlineStart:`calc(100% - ${(e.timeLineItemHeadSize+e.timeLineItemTailWidth)/2}px)`},[`${t}-item-content`]:{width:`calc(100% - ${e.timeLineItemHeadSize+e.marginXS}px)`}}},[`&${t}-pending
        ${t}-item-last
        ${t}-item-tail`]:{display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px dotted ${e.colorSplit}`},[`&${t}-reverse
        ${t}-item-last
        ${t}-item-tail`]:{display:"none"},[`&${t}-reverse ${t}-item-pending`]:{[`${t}-item-tail`]:{insetBlockStart:e.margin,display:"block",height:`calc(100% - ${e.margin}px)`,borderInlineStart:`${e.timeLineItemTailWidth}px dotted ${e.colorSplit}`},[`${t}-item-content`]:{minHeight:e.controlHeightLG*1.2}},[`&${t}-label`]:{[`${t}-item-label`]:{position:"absolute",insetBlockStart:-(e.fontSize*e.lineHeight-e.fontSize)+e.timeLineItemTailWidth,width:`calc(50% - ${e.marginSM}px)`,textAlign:"end"},[`${t}-item-right`]:{[`${t}-item-label`]:{insetInlineStart:`calc(50% + ${e.marginSM}px)`,width:`calc(50% - ${e.marginSM}px)`,textAlign:"start"}}},"&-rtl":{direction:"rtl",[`${t}-item-head-custom`]:{transform:"translate(50%, -50%)"}}})}},Be=de("Timeline",e=>{const t=me(e,{timeLineItemPaddingBottom:e.padding*1.25,timeLineItemHeadSize:10,timeLineItemCustomHeadPaddingVertical:e.paddingXXS,timeLinePaddingInlineEnd:2,timeLineItemTailWidth:e.lineWidthBold,timeLineHeadBorderWidth:e.wireframe?e.lineWidthBold:e.lineWidth*3});return[xe(t)]}),Ee=()=>({prefixCls:String,pending:y.any,pendingDot:y.any,reverse:ee(),mode:y.oneOf(te("left","alternate","right",""))}),E=M({compatConfig:{MODE:3},name:"ATimeline",inheritAttrs:!1,props:Q(Ee(),{reverse:!1,mode:""}),slots:Object,setup(e,t){let{slots:a,attrs:r}=t;const{prefixCls:i,direction:d}=k("timeline",e),[f,p]=Be(i),$=(m,s)=>{const n=m.props||{};return e.mode==="alternate"?n.position==="right"?`${i.value}-item-right`:n.position==="left"?`${i.value}-item-left`:s%2===0?`${i.value}-item-left`:`${i.value}-item-right`:e.mode==="left"?`${i.value}-item-left`:e.mode==="right"?`${i.value}-item-right`:n.position==="right"?`${i.value}-item-right`:""};return()=>{var m,s,n;const{pending:u=(m=a.pending)===null||m===void 0?void 0:m.call(a),pendingDot:h=(s=a.pendingDot)===null||s===void 0?void 0:s.call(a),reverse:L,mode:w}=e,P=typeof u=="boolean"?null:u,b=ge((n=a.default)===null||n===void 0?void 0:n.call(a)),z=u?o(H,{pending:!!u,dot:h||o(pe,null,null)},{default:()=>[P]}):null;z&&b.push(z);const l=L?b.reverse():b,X=l.length,O=`${i.value}-item-last`,re=l.map((T,v)=>{const C=v===X-2?O:"",se=v===X-1?O:"";return he(T,{class:Y([!L&&u?C:se,$(T,v)])})}),V=l.some(T=>{var v,C;return!!(!((v=T.props)===null||v===void 0)&&v.label||!((C=T.children)===null||C===void 0)&&C.label)}),ne=Y(i.value,{[`${i.value}-pending`]:!!u,[`${i.value}-reverse`]:!!L,[`${i.value}-${w}`]:!!w&&!V,[`${i.value}-label`]:V,[`${i.value}-rtl`]:d.value==="rtl"},r.class,p.value);return f(o("ul",F(F({},r),{},{class:ne}),[re]))}}});E.Item=H;E.install=function(e){return e.component(E.name,E),e.component(H.name,H),e};c.Text=R;c.Title=ie;c.Paragraph=ae;c.Link=q;c.Base=be;c.install=function(e){return e.component(c.name,c),e.component(c.Text.displayName,R),e.component(c.Title.displayName,ie),e.component(c.Paragraph.displayName,ae),e.component(c.Link.displayName,q),e};const I=class I{constructor(){N(this,"request");this.request=new ce}static getInstance(){return I.instance||(I.instance=new I),I.instance}async findInteractionById(t){try{const a=await this.request.get(`/interaction/${t}`);return a.code==200?{success:!0,data:a.data}:{success:!1,error:a.message}}catch(a){return{success:!1,error:a.message}}}async findInteractions(t={}){try{const a=await this.request.get("/interaction",{params:t});return a.code==200?{success:!0,data:{interactions:a.data.data,pagination:a.data.pagination}}:{success:!1,error:a.message}}catch(a){return{success:!1,error:a.message}}}async findAllInteractionsByUserId(t){try{const a=await this.request.get(`/interaction-all/${t}`);return a.code==200?{success:!0,data:a.data}:{success:!1,error:a.message}}catch(a){return{success:!1,error:a.message}}}async createInteraction(t){try{const a=await this.request.post("/interaction",{data:t});return a.code==200?{success:!0,data:a.data}:{success:!1,error:a.message}}catch(a){return{success:!1,error:a.message}}}async updateInteractionById(t,a){try{const r=await this.request.put(`/interaction/${t}`,{data:a});return r.code==200?{success:!0,data:r.data}:{success:!1,error:r.message}}catch(r){return{success:!1,error:r.message}}}async deleteInteractionById(t){try{const a=await this.request.delete(`/interaction/${t}`);return a.code==200?{success:!0}:{success:!1,error:a.message}}catch(a){return{success:!1,error:a.message}}}async deleteInteractionByFilter(t){try{const a=await this.request.delete("/interaction",{params:t});return a.code==200?{success:!0}:{success:!1,error:a.message}}catch(a){return{success:!1,error:a.message}}}};N(I,"instance");let W=I;var S=(e=>(e.STAR="STAR",e.COLLECT="COLLECT",e.WATCH="WATCH",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE",e))(S||{});const He={key:0,style:{textAlign:"center",marginTop:"12px",height:"32px",lineHeight:"32px"}},we=M({__name:"TimeLine",setup(e){const t=fe(),a=G([]),r=W.getInstance(),i=G({current:1,size:3,total:0,pages:0}),d=K(!1),f=K(!1);$e(()=>{p(!0)});function p(s=!1){d.value=!0,r.findInteractions({createdBy:t.user._id,current:i.current,size:i.size}).then(n=>{var u,h;s&&a.splice(0,a.length),a.push(...((u=n.data)==null?void 0:u.interactions)||[]),(h=n.data)!=null&&h.pagination&&(i.current=n.data.pagination.current,i.size=n.data.pagination.size,i.total=n.data.pagination.total,i.pages=n.data.pagination.pages,n.data.pagination.total==a.length?f.value=!1:f.value=!0),d.value=!1})}function $(){d.value=!0,i.current=i.current+1,p()}function m(s){switch(s){case S.INSERT:return"var(--insert-color)";case S.UPDATE:return"var(--update-color)";case S.DELETE:return"var(--delete-color)";case S.STAR:return"var(--star-color)";case S.WATCH:return"var(--watch-color)";case S.COLLECT:return"var(--collect-color)";default:throw new Error("No such operate!")}}return(s,n)=>{const u=Le,h=R,L=_e,w=q,P=H,b=Te,z=E;return _(),A(z,{class:"time-line"},{default:g(()=>[o(b,{loading:d.value,"item-layout":"horizontal","data-source":a},{loadMore:g(()=>[!d.value&&f.value?(_(),Z("div",He,[o(u,{onClick:$},{default:g(()=>[x(B(s.$t("loading_more")),1)]),_:1})])):ve("",!0)]),default:g(()=>[(_(!0),Z(Ie,null,Se(a,l=>(_(),A(P,{color:m(l.operation),key:l._id},{default:g(()=>[o(L,{title:J(j)(l.createdAt).format("YYYY-MM-DD: HH:mm:ss")},{default:g(()=>[o(h,{type:"secondary"},{default:g(()=>[x(B(J(j)(l.createdAt).fromNow()),1)]),_:2},1024)]),_:2},1032,["title"]),o(h,{class:"interaction-text"},{default:g(()=>[x(B(l.operation)+" - ",1)]),_:2},1024),l.collectionName=="ARTICLE"?(_(),A(w,{key:0,href:`#/article-detail?_id=${l.documentId+""}`},{default:g(()=>[x(B(l.collectionName),1)]),_:2},1032,["href"])):(_(),A(h,{key:1,type:"success"},{default:g(()=>[x(B(l.collectionName),1)]),_:2},1024))]),_:2},1032,["color"]))),128))]),_:1},8,["loading","data-source"])]),_:1})}}}),Ve=ye(we,[["__scopeId","data-v-490338e0"]]);export{W as I,Ve as T};
