import{cx as xe,at as Ve,cy as je,i as We,cz as qe,cA as _e,cB as fe,cC as Ne,aN as Re,r as Me,aT as Y,ah as He,U as De,H as ie,_ as N,J as $e,c7 as he,cD as Te,g as ze,n as Ue,w as Xe,h as x,cE as Ye,cF as Ge,cG as Ke,ae as Qe,j as Ze,l as ge,P as me,B as Je,o as ne,b as B,s as ve,d as be,c as Be,f as Z,D as et,cH as ce}from"./index-YXsaEbfY.js";import{t as pe,a as tt,d as nt,e as rt,h as le,v as it,i as Ie,_ as at,j as lt,k as st,l as we,m as ae,n as ye,o as ot}from"./loading-BE02Z-wR.js";import{e as ut,f as de,b as ct,c as Le,t as dt}from"./index-BFSLzwoB.js";import{s as ft,o as ht,f as gt}from"./_flatRest-64rrj3zR.js";function Fe(e){return typeof e=="object"&&e!=null&&e.nodeType===1}function Pe(e,t){return(!t||e!=="hidden")&&e!=="visible"&&e!=="clip"}function se(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var r=getComputedStyle(e,null);return Pe(r.overflowY,t)||Pe(r.overflowX,t)||function(a){var n=function(i){if(!i.ownerDocument||!i.ownerDocument.defaultView)return null;try{return i.ownerDocument.defaultView.frameElement}catch{return null}}(a);return!!n&&(n.clientHeight<a.scrollHeight||n.clientWidth<a.scrollWidth)}(e)}return!1}function re(e,t,r,a,n,i,u,h){return i<e&&u>t||i>e&&u<t?0:i<=e&&h<=r||u>=t&&h>=r?i-e-a:u>t&&h<r||i<e&&h>r?u-t+n:0}var Ee=function(e,t){var r=window,a=t.scrollMode,n=t.block,i=t.inline,u=t.boundary,h=t.skipOverflowHiddenElements,p=typeof u=="function"?u:function(Ce){return Ce!==u};if(!Fe(e))throw new TypeError("Invalid target");for(var E,O,k=document.scrollingElement||document.documentElement,M=[],y=e;Fe(y)&&p(y);){if((y=(O=(E=y).parentElement)==null?E.getRootNode().host||null:O)===k){M.push(y);break}y!=null&&y===document.body&&se(y)&&!se(document.documentElement)||y!=null&&se(y,h)&&M.push(y)}for(var T=r.visualViewport?r.visualViewport.width:innerWidth,L=r.visualViewport?r.visualViewport.height:innerHeight,V=window.scrollX||pageXOffset,I=window.scrollY||pageYOffset,C=e.getBoundingClientRect(),s=C.height,l=C.width,m=C.top,c=C.right,f=C.bottom,d=C.left,F=n==="start"||n==="nearest"?m:n==="end"?f:m+s/2,v=i==="center"?d+l/2:i==="end"?c:d,P=[],j=0;j<M.length;j++){var b=M[j],W=b.getBoundingClientRect(),R=W.height,H=W.width,o=W.top,g=W.right,w=W.bottom,S=W.left;if(a==="if-needed"&&m>=0&&d>=0&&f<=L&&c<=T&&m>=o&&f<=w&&d>=S&&c<=g)return P;var _=getComputedStyle(b),$=parseInt(_.borderLeftWidth,10),X=parseInt(_.borderTopWidth,10),q=parseInt(_.borderRightWidth,10),D=parseInt(_.borderBottomWidth,10),A=0,z=0,K="offsetWidth"in b?b.offsetWidth-b.clientWidth-$-q:0,U="offsetHeight"in b?b.offsetHeight-b.clientHeight-X-D:0,Q="offsetWidth"in b?b.offsetWidth===0?0:H/b.offsetWidth:0,ee="offsetHeight"in b?b.offsetHeight===0?0:R/b.offsetHeight:0;if(k===b)A=n==="start"?F:n==="end"?F-L:n==="nearest"?re(I,I+L,L,X,D,I+F,I+F+s,s):F-L/2,z=i==="start"?v:i==="center"?v-T/2:i==="end"?v-T:re(V,V+T,T,$,q,V+v,V+v+l,l),A=Math.max(0,A+I),z=Math.max(0,z+V);else{A=n==="start"?F-o-X:n==="end"?F-w+D+U:n==="nearest"?re(o,w,R,X,D+U,F,F+s,s):F-(o+R/2)+U/2,z=i==="start"?v-S-$:i==="center"?v-(S+H/2)+K/2:i==="end"?v-g+q+K:re(S,g,H,$,q+K,v,v+l,l);var te=b.scrollLeft,J=b.scrollTop;F+=J-(A=Math.max(0,Math.min(J+A/ee,b.scrollHeight-R/ee+U))),v+=te-(z=Math.max(0,Math.min(te+z/Q,b.scrollWidth-H/Q+K)))}P.push({el:b,top:A,left:z})}return P};function Se(e){return e===Object(e)&&Object.keys(e).length!==0}function mt(e,t){t===void 0&&(t="auto");var r="scrollBehavior"in document.body.style;e.forEach(function(a){var n=a.el,i=a.top,u=a.left;n.scroll&&r?n.scroll({top:i,left:u,behavior:t}):(n.scrollTop=i,n.scrollLeft=u)})}function vt(e){return e===!1?{block:"end",inline:"nearest"}:Se(e)?e:{block:"start",inline:"nearest"}}function bt(e,t){var r=e.isConnected||e.ownerDocument.documentElement.contains(e);if(Se(t)&&typeof t.behavior=="function")return t.behavior(r?Ee(e,t):[]);if(r){var a=vt(t);return mt(Ee(e,a),a.behavior)}}function pt(e,t){return ft(ht(e,t,ut),e+"")}function wt(e,t,r){var a=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(n);++a<n;)i[a]=e[a+t];return i}var oe=function(){return xe.Date.now()},yt="Expected a function",Ft=Math.max,Pt=Math.min;function Et(e,t,r){var a,n,i,u,h,p,E=0,O=!1,k=!1,M=!0;if(typeof e!="function")throw new TypeError(yt);t=pe(t)||0,Ve(r)&&(O=!!r.leading,k="maxWait"in r,i=k?Ft(pe(r.maxWait)||0,t):i,M="trailing"in r?!!r.trailing:M);function y(c){var f=a,d=n;return a=n=void 0,E=c,u=e.apply(d,f),u}function T(c){return E=c,h=setTimeout(I,t),O?y(c):u}function L(c){var f=c-p,d=c-E,F=t-f;return k?Pt(F,i-d):F}function V(c){var f=c-p,d=c-E;return p===void 0||f>=t||f<0||k&&d>=i}function I(){var c=oe();if(V(c))return C(c);h=setTimeout(I,L(c))}function C(c){return h=void 0,M&&a?y(c):(a=n=void 0,u)}function s(){h!==void 0&&clearTimeout(h),E=0,a=p=n=h=void 0}function l(){return h===void 0?u:C(oe())}function m(){var c=oe(),f=V(c);if(a=arguments,n=this,p=c,f){if(h===void 0)return T(p);if(k)return clearTimeout(h),h=setTimeout(I,t),y(p)}return h===void 0&&(h=setTimeout(I,t)),u}return m.cancel=s,m.flush=l,m}function Ot(e){return je(e)&&We(e)}function kt(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Mt=Math.min;function Tt(e,t,r){for(var a=Ne,n=e[0].length,i=e.length,u=i,h=Array(i),p=1/0,E=[];u--;){var O=e[u];u&&t&&(O=de(O,qe(t))),p=Mt(O.length,p),h[u]=n>=120&&O.length>=120?new _e(u&&O):void 0}O=e[0];var k=-1,M=h[0];e:for(;++k<n&&E.length<p;){var y=O[k],T=y;if(y=y!==0?y:0,!(M?fe(M,T):a(E,T))){for(u=i;--u;){var L=h[u];if(!(L?fe(L,T):a(e[u],T)))continue e}M&&M.push(T),E.push(y)}}return E}function It(e){return Ot(e)?e:[]}var Lt=pt(function(e){var t=de(e,It);return t.length&&t[0]===e[0]?Tt(t):[]});function St(e,t){return t.length<2?e:ct(e,wt(t,0,-1))}function At(e,t){return t=Le(t,e),e=St(e,t),e==null||delete e[dt(kt(t))]}function Ct(e){return Re(e)?void 0:e}var xt=1,Vt=2,jt=4,Wt=gt(function(e,t){var r={};if(e==null)return r;var a=!1;t=de(t,function(i){return i=Le(i,e),a||(a=i.length>1),i}),tt(e,nt(e),r),a&&(r=rt(r,xt|Vt|jt,Ct));for(var n=t.length;n--;)At(r,t[n]);return r});function Ae(e){let t=!1,r=e.length;const a=[];return e.length?new Promise((n,i)=>{e.forEach((u,h)=>{u.catch(p=>(t=!0,p)).then(p=>{r-=1,a[h]=p,!(r>0)&&(t&&i(a),n(a))})})}):Promise.resolve([])}function Oe(e){let t=!1;return e&&e.length&&e.every(r=>r.required?(t=!0,!1):!0),t}function ke(e){return e==null?[]:Array.isArray(e)?e:[e]}function ue(e,t,r){let a=e;t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");const n=t.split(".");let i=0;for(let u=n.length;i<u-1&&!(!a&&!r);++i){const h=n[i];if(h in a)a=a[h];else{if(r)throw new Error("please transfer a valid name path to validate!");break}}return{o:a,k:n[i],v:a?a[n[i]]:null,isValid:a&&n[i]in a}}function qt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Me({}),r=arguments.length>2?arguments[2]:void 0;const a=le(Y(e)),n=He({}),i=De([]),u=s=>{N(Y(e),N(N({},le(a)),s)),$e(()=>{Object.keys(n).forEach(l=>{n[l]={autoLink:!1,required:Oe(Y(t)[l])}})})},h=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],l=arguments.length>1?arguments[1]:void 0;return l.length?s.filter(m=>{const c=ke(m.trigger||"change");return Lt(c,l).length}):s};let p=null;const E=function(s){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0;const c=[],f={};for(let v=0;v<s.length;v++){const P=s[v],j=ue(Y(e),P,m);if(!j.isValid)continue;f[P]=j.v;const b=h(Y(t)[P],ke(l&&l.trigger));b.length&&c.push(O(P,j.v,b,l||{}).then(()=>({name:P,errors:[],warnings:[]})).catch(W=>{const R=[],H=[];return W.forEach(o=>{let{rule:{warningOnly:g},errors:w}=o;g?H.push(...w):R.push(...w)}),R.length?Promise.reject({name:P,errors:R,warnings:H}):{name:P,errors:R,warnings:H}}))}const d=Ae(c);p=d;const F=d.then(()=>p===d?Promise.resolve(f):Promise.reject([])).catch(v=>{const P=v.filter(j=>j&&j.errors.length);return P.length?Promise.reject({values:f,errorFields:P,outOfDate:p!==d}):Promise.resolve(f)});return F.catch(v=>v),F},O=function(s,l,m){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const f=it([s],l,m,N({validateMessages:Ie},c),!!c.validateFirst);return n[s]?(n[s].validateStatus="validating",f.catch(d=>d).then(function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var F;if(n[s].validateStatus==="validating"){const v=d.filter(P=>P&&P.errors.length);n[s].validateStatus=v.length?"error":"success",n[s].help=v.length?v.map(P=>P.errors):null,(F=r==null?void 0:r.onValidate)===null||F===void 0||F.call(r,s,!v.length,v.length?he(n[s].help[0]):null)}}),f):f.catch(d=>d)},k=(s,l)=>{let m=[],c=!0;s?Array.isArray(s)?m=s:m=[s]:(c=!1,m=i.value);const f=E(m,l||{},c);return f.catch(d=>d),f},M=s=>{let l=[];s?Array.isArray(s)?l=s:l=[s]:l=i.value,l.forEach(m=>{n[m]&&N(n[m],{validateStatus:"",help:null})})},y=s=>{const l={autoLink:!1},m=[],c=Array.isArray(s)?s:[s];for(let f=0;f<c.length;f++){const d=c[f];(d==null?void 0:d.validateStatus)==="error"&&(l.validateStatus="error",d.help&&m.push(d.help)),l.required=l.required||(d==null?void 0:d.required)}return l.help=m,l};let T=a,L=!0;const V=s=>{const l=[];i.value.forEach(m=>{const c=ue(s,m,!1),f=ue(T,m,!1);(L&&(r==null?void 0:r.immediate)&&c.isValid||!Te(c.v,f.v))&&l.push(m)}),k(l,{trigger:"change"}),L=!1,T=le(he(s))},I=r==null?void 0:r.debounce;let C=!0;return ie(t,()=>{i.value=t?Object.keys(Y(t)):[],!C&&r&&r.validateOnRuleChange&&k(),C=!1},{deep:!0,immediate:!0}),ie(i,()=>{const s={};i.value.forEach(l=>{s[l]=N({},n[l],{autoLink:!1,required:Oe(Y(t)[l])}),delete n[l]});for(const l in n)Object.prototype.hasOwnProperty.call(n,l)&&delete n[l];N(n,s)},{immediate:!0}),ie(e,I&&I.wait?Et(V,I.wait,Wt(I,["wait"])):V,{immediate:r&&!!r.immediate,deep:!0}),{modelRef:e,rulesRef:t,initialModel:a,validateInfos:n,resetFields:u,validate:k,validateField:O,mergeValidateInfo:y,clearValidate:M}}const _t=()=>({layout:me.oneOf(Je("horizontal","inline","vertical")),labelCol:ne(),wrapperCol:ne(),colon:B(),labelAlign:ve(),labelWrap:B(),prefixCls:String,requiredMark:be([String,Boolean]),hideRequiredMark:B(),model:me.object,rules:ne(),validateMessages:ne(),validateOnRuleChange:B(),scrollToFirstError:Be(),onSubmit:Z(),name:String,validateTrigger:be([String,Array]),size:ve(),disabled:B(),onValuesChange:Z(),onFieldsChange:Z(),onFinish:Z(),onFinishFailed:Z(),onValidate:Z()});function Nt(e,t){return Te(ae(e),ae(t))}const G=ze({compatConfig:{MODE:3},name:"AForm",inheritAttrs:!1,props:Ue(_t(),{layout:"horizontal",hideRequiredMark:!1,colon:!0}),Item:at,useForm:qt,setup(e,t){let{emit:r,slots:a,expose:n,attrs:i}=t;const{prefixCls:u,direction:h,form:p,size:E,disabled:O}=Xe("form",e),k=x(()=>e.requiredMark===""||e.requiredMark),M=x(()=>{var o;return k.value!==void 0?k.value:p&&((o=p.value)===null||o===void 0?void 0:o.requiredMark)!==void 0?p.value.requiredMark:!e.hideRequiredMark});Ye(E),Ge(O);const y=x(()=>{var o,g;return(o=e.colon)!==null&&o!==void 0?o:(g=p.value)===null||g===void 0?void 0:g.colon}),{validateMessages:T}=Ke(),L=x(()=>N(N(N({},Ie),T.value),e.validateMessages)),[V,I]=lt(u),C=x(()=>Qe(u.value,{[`${u.value}-${e.layout}`]:!0,[`${u.value}-hide-required-mark`]:M.value===!1,[`${u.value}-rtl`]:h.value==="rtl",[`${u.value}-${E.value}`]:E.value},I.value)),s=Me(),l={},m=(o,g)=>{l[o]=g},c=o=>{delete l[o]},f=o=>{const g=!!o,w=g?ae(o).map(ye):[];return g?Object.values(l).filter(S=>w.findIndex(_=>Nt(_,S.fieldName.value))>-1):Object.values(l)},d=o=>{e.model&&f(o).forEach(g=>{g.resetField()})},F=o=>{f(o).forEach(g=>{g.clearValidate()})},v=o=>{const{scrollToFirstError:g}=e;if(r("finishFailed",o),g&&o.errorFields.length){let w={};typeof g=="object"&&(w=g),j(o.errorFields[0].name,w)}},P=function(){return R(...arguments)},j=function(o){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const w=f(o?[o]:void 0);if(w.length){const S=w[0].fieldId.value,_=S?document.getElementById(S):null;_&&bt(_,N({scrollMode:"if-needed",block:"nearest"},g))}},b=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0){const g=[];return Object.values(l).forEach(w=>{let{namePath:S}=w;g.push(S.value)}),we(e.model,g)}else return we(e.model,o)},W=(o,g)=>{if(!e.model)return Promise.reject("Form `model` is required for validateFields to work.");const w=!!o,S=w?ae(o).map(ye):[],_=[];Object.values(l).forEach(q=>{var D;if(w||S.push(q.namePath.value),!(!((D=q.rules)===null||D===void 0)&&D.value.length))return;const A=q.namePath.value;if(!w||ot(S,A)){const z=q.validateRules(N({validateMessages:L.value},g));_.push(z.then(()=>({name:A,errors:[],warnings:[]})).catch(K=>{const U=[],Q=[];return K.forEach(ee=>{let{rule:{warningOnly:te},errors:J}=ee;te?Q.push(...J):U.push(...J)}),U.length?Promise.reject({name:A,errors:U,warnings:Q}):{name:A,errors:U,warnings:Q}}))}});const $=Ae(_);s.value=$;const X=$.then(()=>s.value===$?Promise.resolve(b(S)):Promise.reject([])).catch(q=>{const D=q.filter(A=>A&&A.errors.length);return Promise.reject({values:b(S),errorFields:D,outOfDate:s.value!==$})});return X.catch(q=>q),X},R=function(){return W(...arguments)},H=o=>{o.preventDefault(),o.stopPropagation(),r("submit",o),e.model&&W().then(w=>{r("finish",w)}).catch(w=>{v(w)})};return n({resetFields:d,clearValidate:F,validateFields:W,getFieldsValue:b,validate:P,scrollToField:j}),st({model:x(()=>e.model),name:x(()=>e.name),labelAlign:x(()=>e.labelAlign),labelCol:x(()=>e.labelCol),labelWrap:x(()=>e.labelWrap),wrapperCol:x(()=>e.wrapperCol),vertical:x(()=>e.layout==="vertical"),colon:y,requiredMark:M,validateTrigger:x(()=>e.validateTrigger),rules:x(()=>e.rules),addField:m,removeField:c,onValidate:(o,g,w)=>{r("validate",o,g,w)},validateMessages:L}),ie(()=>e.rules,()=>{e.validateOnRuleChange&&W()}),()=>{var o;return V(Ze("form",ge(ge({},i),{},{onSubmit:H,class:[C.value,i.class]}),[(o=a.default)===null||o===void 0?void 0:o.call(a)]))}}});G.useInjectFormItemContext=et;G.ItemRest=ce;G.install=function(e){return e.component(G.name,G),e.component(G.Item.name,G.Item),e.component(ce.name,ce),e};export{G as F};
