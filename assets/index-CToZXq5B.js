import{d as H,I as K,h as u,n as L,o as O,M as l,p as m,q as N,c as a,K as t,aU as Q,O as d,x as n,F as Z,y as z,P as G,C as p,t as J,aw as W,ax as X,Z as ee,Q as te,E as oe}from"./index-CorvJS88.js";import{d as f}from"./dayjs.min-CNgtDw1V.js";import{F as ae}from"./file.service-BzdYX6aG.js";import{B as re}from"./index-CMYvEKCm.js";import{T as ne}from"./index-aD2pe-_V.js";import{T as se}from"./Text-Cl0HkLD1.js";import{P as ie}from"./Paragraph-D8tPocoY.js";import{S as le}from"./index-DrHQ6tjo.js";import{_ as pe,a as ue,b as de}from"./index-BVVtlcms.js";import"./request-DbUJaofx.js";import"./RightOutlined-Cu8YZTQd.js";import"./Base-C89d3xn4.js";import"./Dropdown-Bfe-joDI.js";import"./ActionButton-BakDm9yD.js";import"./index-BenU8wJE.js";const _e={class:"repository"},ce=["src"],me=H({__name:"index",setup(fe){var h;const D=W(),S=X(),y=K(),v=ae.getInstance(),o=u(),g=u(!0),T=u(),C=u(y.tags),F=L([{path:"/",breadcrumbName:"Home"},{path:"/repository",breadcrumbName:"Repository"},{path:"/repository-info",breadcrumbName:((h=o.value)==null?void 0:h.title)||""}]);O(()=>{const s=D.query._id;if(!s)throw new Error("No such repository");v.findFileById(s).then(e=>{console.log(e),e.success&&e.data?o.value=e.data:l.error(e.error)}).catch(e=>l.error(e.message)).finally(()=>g.value=!1)});function A(){var s;S.push({path:"/publish",query:{_id:((s=o.value)==null?void 0:s._id)+"",type:"File"}})}function I(){var s,e;if(!((s=o.value)!=null&&s._id))throw new Error("No such Repository");v.deletePerpetualById((e=o.value)==null?void 0:e._id).then(i=>{i.success?l.success(i.message):l.error(i.error)}).catch(i=>l.error(i.message))}function R(){l.info("删除操作已取消")}return(s,e)=>{const i=re,E=pe,P=ne,q=ue,_=se,c=ee,U=te,V=ie,j=de,$=le;return m(),N("div",_e,[a($,{spinning:g.value},{default:t(()=>{var x,b,w,Y,B,k;return[a(q,{title:(x=o.value)==null?void 0:x.title,class:"repository-detail-header",avatar:{src:(b=T.value)==null?void 0:b.avatar},breadcrumb:{routes:F},onBack:e[0]||(e[0]=()=>s.$router.go(-1))},Q({tags:t(()=>[(m(!0),N(Z,null,z(C.value,r=>(m(),G(P,{color:"blue",key:r._id},{default:t(()=>[n(p(r.name),1)]),_:2},1024))),128))]),_:2},[((w=o.value)==null?void 0:w.createdBy)==d(y).user._id?{name:"extra",fn:t(()=>[a(i,{type:"primary",onClick:A},{default:t(()=>e[1]||(e[1]=[n("修改")])),_:1}),a(E,{title:"确认删除?",onConfirm:I,onCancel:R,okText:"确认",cancelText:"取消"},{default:t(()=>[a(i,{type:"primary",danger:""},{default:t(()=>e[2]||(e[2]=[n("删除")])),_:1})]),_:1})]),key:"0"}:void 0]),1032,["title","avatar","breadcrumb"]),a(U,{gap:"20",wrap:"wrap",class:"repository-function",justify:"flex-end"},{default:t(()=>[a(c,null,{title:t(()=>e[3]||(e[3]=[n("创建时间")])),default:t(()=>[a(_,{type:"secondary"},{default:t(()=>{var r;return[n("创建于: "+p(d(f)((r=o.value)==null?void 0:r.createdAt).format("YYYY-MM-DD")),1)]}),_:1})]),_:1}),a(c,null,{title:t(()=>e[4]||(e[4]=[n("更新日期")])),default:t(()=>[a(_,{type:"secondary"},{default:t(()=>{var r;return[n("更新于: "+p(d(f)((r=o.value)==null?void 0:r.updatedAt).format("YYYY-MM-DD")),1)]}),_:1})]),_:1}),a(c,null,{title:t(()=>e[5]||(e[5]=[n("过期时间")])),default:t(()=>[a(_,{type:"secondary"},{default:t(()=>{var r,M;return[n("过期于: "+p((r=o.value)!=null&&r.expiredAt?d(f)((M=o.value)==null?void 0:M.expiredAt).format("YYYY-MM-DD"):"永久"),1)]}),_:1})]),_:1})]),_:1}),a(V,null,{default:t(()=>{var r;return[n(p((r=o.value)==null?void 0:r.description),1)]}),_:1}),a(i,{class:"download-button",type:"primary",href:(Y=o.value)==null?void 0:Y.dataUrl,download:(B=o.value)==null?void 0:B.filename},{default:t(()=>e[6]||(e[6]=[n("下载")])),_:1},8,["href","download"]),a(j,{class:"divider"}),J("embed",{src:(k=o.value)==null?void 0:k.dataUrl,style:{height:"60vh",width:"100%"}},null,8,ce)]}),_:1},8,["spinning"])])}}}),Ce=oe(me,[["__scopeId","data-v-13d8074c"]]);export{Ce as default};
