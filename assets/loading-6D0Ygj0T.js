import{ct as We,aw as qe,cu as _e,i as Ne,cv as Re,cw as De,cx as he,cy as He,aQ as $e,A as Ie,aU as Y,r as ze,a6 as Ue,V as le,y as R,X as Xe,c6 as ge,cz as Le,d as Qe,D as Ye,J as Ke,x as V,cA as Ge,cB as Ze,cC as Je,ap as Be,b as Ce,z as me,a1 as ve,Q as et,p as re,m as ee,s as pe,q as be,n as tt,l as J,R as nt,cD as de,bP as ye}from"./index-DkCCnXu_.js";import{t as we,c as rt,g as it,a as lt,d as se,v as at,e as Se,_ as st,f as ot,h as ut,i as Fe,j as ae,k as Pe,l as ct}from"./FormItem-v_r1KCTa.js";import{e as dt,f as fe,b as ft,c as xe,t as ht,S as gt}from"./index-Br9fc7u-.js";import{s as mt,o as vt,f as pt}from"./_flatRest-BPohVbsA.js";function Ee(e){return typeof e=="object"&&e!=null&&e.nodeType===1}function Oe(e,t){return(!t||e!=="hidden")&&e!=="visible"&&e!=="clip"}function oe(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var r=getComputedStyle(e,null);return Oe(r.overflowY,t)||Oe(r.overflowX,t)||function(l){var n=function(i){if(!i.ownerDocument||!i.ownerDocument.defaultView)return null;try{return i.ownerDocument.defaultView.frameElement}catch{return null}}(l);return!!n&&(n.clientHeight<l.scrollHeight||n.clientWidth<l.scrollWidth)}(e)}return!1}function ie(e,t,r,l,n,i,u,h){return i<e&&u>t||i>e&&u<t?0:i<=e&&h<=r||u>=t&&h>=r?i-e-l:u>t&&h<r||i<e&&h>r?u-t+n:0}var ke=function(e,t){var r=window,l=t.scrollMode,n=t.block,i=t.inline,u=t.boundary,h=t.skipOverflowHiddenElements,b=typeof u=="function"?u:function(je){return je!==u};if(!Ee(e))throw new TypeError("Invalid target");for(var E,O,k=document.scrollingElement||document.documentElement,M=[],w=e;Ee(w)&&b(w);){if((w=(O=(E=w).parentElement)==null?E.getRootNode().host||null:O)===k){M.push(w);break}w!=null&&w===document.body&&oe(w)&&!oe(document.documentElement)||w!=null&&oe(w,h)&&M.push(w)}for(var T=r.visualViewport?r.visualViewport.width:innerWidth,C=r.visualViewport?r.visualViewport.height:innerHeight,j=window.scrollX||pageXOffset,L=window.scrollY||pageYOffset,A=e.getBoundingClientRect(),s=A.height,a=A.width,m=A.top,c=A.right,f=A.bottom,d=A.left,F=n==="start"||n==="nearest"?m:n==="end"?f:m+s/2,v=i==="center"?d+a/2:i==="end"?c:d,P=[],W=0;W<M.length;W++){var p=M[W],q=p.getBoundingClientRect(),D=q.height,H=q.width,o=q.top,g=q.right,y=q.bottom,S=q.left;if(l==="if-needed"&&m>=0&&d>=0&&f<=C&&c<=T&&m>=o&&f<=y&&d>=S&&c<=g)return P;var N=getComputedStyle(p),z=parseInt(N.borderLeftWidth,10),Q=parseInt(N.borderTopWidth,10),_=parseInt(N.borderRightWidth,10),$=parseInt(N.borderBottomWidth,10),x=0,U=0,G="offsetWidth"in p?p.offsetWidth-p.clientWidth-z-_:0,X="offsetHeight"in p?p.offsetHeight-p.clientHeight-Q-$:0,Z="offsetWidth"in p?p.offsetWidth===0?0:H/p.offsetWidth:0,te="offsetHeight"in p?p.offsetHeight===0?0:D/p.offsetHeight:0;if(k===p)x=n==="start"?F:n==="end"?F-C:n==="nearest"?ie(L,L+C,C,Q,$,L+F,L+F+s,s):F-C/2,U=i==="start"?v:i==="center"?v-T/2:i==="end"?v-T:ie(j,j+T,T,z,_,j+v,j+v+a,a),x=Math.max(0,x+L),U=Math.max(0,U+j);else{x=n==="start"?F-o-Q:n==="end"?F-y+$+X:n==="nearest"?ie(o,y,D,Q,$+X,F,F+s,s):F-(o+D/2)+X/2,U=i==="start"?v-S-z:i==="center"?v-(S+H/2)+G/2:i==="end"?v-g+_+G:ie(S,g,H,z,_+G,v,v+a,a);var ne=p.scrollLeft,B=p.scrollTop;F+=B-(x=Math.max(0,Math.min(B+x/te,p.scrollHeight-D/te+X))),v+=ne-(U=Math.max(0,Math.min(ne+U/Z,p.scrollWidth-H/Z+G)))}P.push({el:p,top:x,left:U})}return P};function Ae(e){return e===Object(e)&&Object.keys(e).length!==0}function bt(e,t){t===void 0&&(t="auto");var r="scrollBehavior"in document.body.style;e.forEach(function(l){var n=l.el,i=l.top,u=l.left;n.scroll&&r?n.scroll({top:i,left:u,behavior:t}):(n.scrollTop=i,n.scrollLeft=u)})}function yt(e){return e===!1?{block:"end",inline:"nearest"}:Ae(e)?e:{block:"start",inline:"nearest"}}function wt(e,t){var r=e.isConnected||e.ownerDocument.documentElement.contains(e);if(Ae(t)&&typeof t.behavior=="function")return t.behavior(r?ke(e,t):[]);if(r){var l=yt(t);return bt(ke(e,l),l.behavior)}}function Ft(e,t){return mt(vt(e,t,dt),e+"")}function Pt(e,t,r){var l=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(n);++l<n;)i[l]=e[l+t];return i}var ue=function(){return We.Date.now()},Et="Expected a function",Ot=Math.max,kt=Math.min;function Mt(e,t,r){var l,n,i,u,h,b,E=0,O=!1,k=!1,M=!0;if(typeof e!="function")throw new TypeError(Et);t=we(t)||0,qe(r)&&(O=!!r.leading,k="maxWait"in r,i=k?Ot(we(r.maxWait)||0,t):i,M="trailing"in r?!!r.trailing:M);function w(c){var f=l,d=n;return l=n=void 0,E=c,u=e.apply(d,f),u}function T(c){return E=c,h=setTimeout(L,t),O?w(c):u}function C(c){var f=c-b,d=c-E,F=t-f;return k?kt(F,i-d):F}function j(c){var f=c-b,d=c-E;return b===void 0||f>=t||f<0||k&&d>=i}function L(){var c=ue();if(j(c))return A(c);h=setTimeout(L,C(c))}function A(c){return h=void 0,M&&l?w(c):(l=n=void 0,u)}function s(){h!==void 0&&clearTimeout(h),E=0,l=b=n=h=void 0}function a(){return h===void 0?u:A(ue())}function m(){var c=ue(),f=j(c);if(l=arguments,n=this,b=c,f){if(h===void 0)return T(b);if(k)return clearTimeout(h),h=setTimeout(L,t),w(b)}return h===void 0&&(h=setTimeout(L,t)),u}return m.cancel=s,m.flush=a,m}function Tt(e){return _e(e)&&Ne(e)}function It(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Lt=Math.min;function Ct(e,t,r){for(var l=He,n=e[0].length,i=e.length,u=i,h=Array(i),b=1/0,E=[];u--;){var O=e[u];u&&t&&(O=fe(O,Re(t))),b=Lt(O.length,b),h[u]=n>=120&&O.length>=120?new De(u&&O):void 0}O=e[0];var k=-1,M=h[0];e:for(;++k<n&&E.length<b;){var w=O[k],T=w;if(w=w!==0?w:0,!(M?he(M,T):l(E,T))){for(u=i;--u;){var C=h[u];if(!(C?he(C,T):l(e[u],T)))continue e}M&&M.push(T),E.push(w)}}return E}function St(e){return Tt(e)?e:[]}var xt=Ft(function(e){var t=fe(e,St);return t.length&&t[0]===e[0]?Ct(t):[]});function At(e,t){return t.length<2?e:ft(e,Pt(t,0,-1))}function Vt(e,t){return t=xe(t,e),e=At(e,t),e==null||delete e[ht(It(t))]}function jt(e){return $e(e)?void 0:e}var Wt=1,qt=2,_t=4,Nt=pt(function(e,t){var r={};if(e==null)return r;var l=!1;t=fe(t,function(i){return i=xe(i,e),l||(l=i.length>1),i}),rt(e,it(e),r),l&&(r=lt(r,Wt|qt|_t,jt));for(var n=t.length;n--;)Vt(r,t[n]);return r});function Ve(e){let t=!1,r=e.length;const l=[];return e.length?new Promise((n,i)=>{e.forEach((u,h)=>{u.catch(b=>(t=!0,b)).then(b=>{r-=1,l[h]=b,!(r>0)&&(t&&i(l),n(l))})})}):Promise.resolve([])}function Me(e){let t=!1;return e&&e.length&&e.every(r=>r.required?(t=!0,!1):!0),t}function Te(e){return e==null?[]:Array.isArray(e)?e:[e]}function ce(e,t,r){let l=e;t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");const n=t.split(".");let i=0;for(let u=n.length;i<u-1&&!(!l&&!r);++i){const h=n[i];if(h in l)l=l[h];else{if(r)throw new Error("please transfer a valid name path to validate!");break}}return{o:l,k:n[i],v:l?l[n[i]]:null,isValid:l&&n[i]in l}}function Rt(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ie({}),r=arguments.length>2?arguments[2]:void 0;const l=se(Y(e)),n=ze({}),i=Ue([]),u=s=>{R(Y(e),R(R({},se(l)),s)),Xe(()=>{Object.keys(n).forEach(a=>{n[a]={autoLink:!1,required:Me(Y(t)[a])}})})},h=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;return a.length?s.filter(m=>{const c=Te(m.trigger||"change");return xt(c,a).length}):s};let b=null;const E=function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0;const c=[],f={};for(let v=0;v<s.length;v++){const P=s[v],W=ce(Y(e),P,m);if(!W.isValid)continue;f[P]=W.v;const p=h(Y(t)[P],Te(a&&a.trigger));p.length&&c.push(O(P,W.v,p,a||{}).then(()=>({name:P,errors:[],warnings:[]})).catch(q=>{const D=[],H=[];return q.forEach(o=>{let{rule:{warningOnly:g},errors:y}=o;g?H.push(...y):D.push(...y)}),D.length?Promise.reject({name:P,errors:D,warnings:H}):{name:P,errors:D,warnings:H}}))}const d=Ve(c);b=d;const F=d.then(()=>b===d?Promise.resolve(f):Promise.reject([])).catch(v=>{const P=v.filter(W=>W&&W.errors.length);return P.length?Promise.reject({values:f,errorFields:P,outOfDate:b!==d}):Promise.resolve(f)});return F.catch(v=>v),F},O=function(s,a,m){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const f=at([s],a,m,R({validateMessages:Se},c),!!c.validateFirst);return n[s]?(n[s].validateStatus="validating",f.catch(d=>d).then(function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var F;if(n[s].validateStatus==="validating"){const v=d.filter(P=>P&&P.errors.length);n[s].validateStatus=v.length?"error":"success",n[s].help=v.length?v.map(P=>P.errors):null,(F=r==null?void 0:r.onValidate)===null||F===void 0||F.call(r,s,!v.length,v.length?ge(n[s].help[0]):null)}}),f):f.catch(d=>d)},k=(s,a)=>{let m=[],c=!0;s?Array.isArray(s)?m=s:m=[s]:(c=!1,m=i.value);const f=E(m,a||{},c);return f.catch(d=>d),f},M=s=>{let a=[];s?Array.isArray(s)?a=s:a=[s]:a=i.value,a.forEach(m=>{n[m]&&R(n[m],{validateStatus:"",help:null})})},w=s=>{const a={autoLink:!1},m=[],c=Array.isArray(s)?s:[s];for(let f=0;f<c.length;f++){const d=c[f];(d==null?void 0:d.validateStatus)==="error"&&(a.validateStatus="error",d.help&&m.push(d.help)),a.required=a.required||(d==null?void 0:d.required)}return a.help=m,a};let T=l,C=!0;const j=s=>{const a=[];i.value.forEach(m=>{const c=ce(s,m,!1),f=ce(T,m,!1);(C&&(r==null?void 0:r.immediate)&&c.isValid||!Le(c.v,f.v))&&a.push(m)}),k(a,{trigger:"change"}),C=!1,T=se(ge(s))},L=r==null?void 0:r.debounce;let A=!0;return le(t,()=>{i.value=t?Object.keys(Y(t)):[],!A&&r&&r.validateOnRuleChange&&k(),A=!1},{deep:!0,immediate:!0}),le(i,()=>{const s={};i.value.forEach(a=>{s[a]=R({},n[a],{autoLink:!1,required:Me(Y(t)[a])}),delete n[a]});for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&delete n[a];R(n,s)},{immediate:!0}),le(e,L&&L.wait?Mt(j,L.wait,Nt(L,["wait"])):j,{immediate:r&&!!r.immediate,deep:!0}),{modelRef:e,rulesRef:t,initialModel:l,validateInfos:n,resetFields:u,validate:k,validateField:O,mergeValidateInfo:w,clearValidate:M}}const Dt=()=>({layout:ve.oneOf(et("horizontal","inline","vertical")),labelCol:re(),wrapperCol:re(),colon:ee(),labelAlign:pe(),labelWrap:ee(),prefixCls:String,requiredMark:be([String,Boolean]),hideRequiredMark:ee(),model:ve.object,rules:re(),validateMessages:re(),validateOnRuleChange:ee(),scrollToFirstError:tt(),onSubmit:J(),name:String,validateTrigger:be([String,Array]),size:pe(),disabled:ee(),onValuesChange:J(),onFieldsChange:J(),onFinish:J(),onFinishFailed:J(),onValidate:J()});function Ht(e,t){return Le(ae(e),ae(t))}const K=Qe({compatConfig:{MODE:3},name:"AForm",inheritAttrs:!1,props:Ye(Dt(),{layout:"horizontal",hideRequiredMark:!1,colon:!0}),Item:st,useForm:Rt,setup(e,t){let{emit:r,slots:l,expose:n,attrs:i}=t;const{prefixCls:u,direction:h,form:b,size:E,disabled:O}=Ke("form",e),k=V(()=>e.requiredMark===""||e.requiredMark),M=V(()=>{var o;return k.value!==void 0?k.value:b&&((o=b.value)===null||o===void 0?void 0:o.requiredMark)!==void 0?b.value.requiredMark:!e.hideRequiredMark});Ge(E),Ze(O);const w=V(()=>{var o,g;return(o=e.colon)!==null&&o!==void 0?o:(g=b.value)===null||g===void 0?void 0:g.colon}),{validateMessages:T}=Je(),C=V(()=>R(R(R({},Se),T.value),e.validateMessages)),[j,L]=ot(u),A=V(()=>Be(u.value,{[`${u.value}-${e.layout}`]:!0,[`${u.value}-hide-required-mark`]:M.value===!1,[`${u.value}-rtl`]:h.value==="rtl",[`${u.value}-${E.value}`]:E.value},L.value)),s=Ie(),a={},m=(o,g)=>{a[o]=g},c=o=>{delete a[o]},f=o=>{const g=!!o,y=g?ae(o).map(Pe):[];return g?Object.values(a).filter(S=>y.findIndex(N=>Ht(N,S.fieldName.value))>-1):Object.values(a)},d=o=>{e.model&&f(o).forEach(g=>{g.resetField()})},F=o=>{f(o).forEach(g=>{g.clearValidate()})},v=o=>{const{scrollToFirstError:g}=e;if(r("finishFailed",o),g&&o.errorFields.length){let y={};typeof g=="object"&&(y=g),W(o.errorFields[0].name,y)}},P=function(){return D(...arguments)},W=function(o){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const y=f(o?[o]:void 0);if(y.length){const S=y[0].fieldId.value,N=S?document.getElementById(S):null;N&&wt(N,R({scrollMode:"if-needed",block:"nearest"},g))}},p=function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(o===!0){const g=[];return Object.values(a).forEach(y=>{let{namePath:S}=y;g.push(S.value)}),Fe(e.model,g)}else return Fe(e.model,o)},q=(o,g)=>{if(!e.model)return Promise.reject("Form `model` is required for validateFields to work.");const y=!!o,S=y?ae(o).map(Pe):[],N=[];Object.values(a).forEach(_=>{var $;if(y||S.push(_.namePath.value),!(!(($=_.rules)===null||$===void 0)&&$.value.length))return;const x=_.namePath.value;if(!y||ct(S,x)){const U=_.validateRules(R({validateMessages:C.value},g));N.push(U.then(()=>({name:x,errors:[],warnings:[]})).catch(G=>{const X=[],Z=[];return G.forEach(te=>{let{rule:{warningOnly:ne},errors:B}=te;ne?Z.push(...B):X.push(...B)}),X.length?Promise.reject({name:x,errors:X,warnings:Z}):{name:x,errors:X,warnings:Z}}))}});const z=Ve(N);s.value=z;const Q=z.then(()=>s.value===z?Promise.resolve(p(S)):Promise.reject([])).catch(_=>{const $=_.filter(x=>x&&x.errors.length);return Promise.reject({values:p(S),errorFields:$,outOfDate:s.value!==z})});return Q.catch(_=>_),Q},D=function(){return q(...arguments)},H=o=>{o.preventDefault(),o.stopPropagation(),r("submit",o),e.model&&q().then(y=>{r("finish",y)}).catch(y=>{v(y)})};return n({resetFields:d,clearValidate:F,validateFields:q,getFieldsValue:p,validate:P,scrollToField:W}),ut({model:V(()=>e.model),name:V(()=>e.name),labelAlign:V(()=>e.labelAlign),labelCol:V(()=>e.labelCol),labelWrap:V(()=>e.labelWrap),wrapperCol:V(()=>e.wrapperCol),vertical:V(()=>e.layout==="vertical"),colon:w,requiredMark:M,validateTrigger:V(()=>e.validateTrigger),rules:V(()=>e.rules),addField:m,removeField:c,onValidate:(o,g,y)=>{r("validate",o,g,y)},validateMessages:C}),le(()=>e.rules,()=>{e.validateOnRuleChange&&q()}),()=>{var o;return j(Ce("form",me(me({},i),{},{onSubmit:H,class:[A.value,i.class]}),[(o=l.default)===null||o===void 0?void 0:o.call(l)]))}}});K.useInjectFormItemContext=nt;K.ItemRest=de;K.install=function(e){return e.component(K.name,K),e.component(K.Item.name,K.Item),e.component(de.name,de),e};let I=null;const Qt={show(){if(!I){I=document.createElement("div"),I.style.position="fixed",I.style.top="0",I.style.left="0",I.style.width="100%",I.style.height="100%",I.style.display="flex",I.style.justifyContent="center",I.style.alignItems="center",I.style.backgroundColor="rgba(255, 255, 255, 0.8)",I.style.zIndex="9999",document.body.appendChild(I);const e=Ce(gt,{size:"large",spinning:!0});ye(e,I)}},hide(){I&&(ye(null,I),document.body.removeChild(I),I=null)}};export{K as F,Qt as L};
